<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Johniverse Portal üåå</title>
<style>
*{box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{margin:0;background:url('https://wallpapercave.com/wp/wp10816761.jpg') no-repeat center center/cover;color:white;min-height:100vh;display:flex;justify-content:center;align-items:center;}
#loading-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle,#0d0d0d,#000);display:flex;justify-content:center;align-items:center;flex-direction:column;z-index:9999;}
.loader{width:70px;height:70px;border:8px solid rgba(255,255,255,0.2);border-top:8px solid #a84eff;border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{from{transform:rotate(0);}to{transform:rotate(360deg);}}
#loading-text{color:#d7baff;margin-top:10px;}
.container{display:none;background:rgba(0,0,0,0.75);padding:20px;border-radius:15px;box-shadow:0 0 15px #a84eff;width:90%;max-width:400px;text-align:center;}
h1{color:#d7baff;}
input{width:90%;padding:10px;margin:10px;border:none;border-radius:5px;background:rgba(255,255,255,0.1);color:white;}
button{background:#a84eff;border:none;padding:10px 20px;border-radius:5px;color:white;font-weight:bold;cursor:pointer;margin-top:10px;}
button:hover{background:#c07bff;}
.link{color:#d7baff;cursor:pointer;display:block;margin-top:10px;}
#dashboard{display:none;flex-direction:column;align-items:center;background:rgba(0,0,0,0.8);border-radius:15px;padding:20px;box-shadow:0 0 20px #a84eff;width:90%;max-width:700px;text-align:center;position:relative;}
.pfp-container{position:relative;display:inline-block;}
#pfp{width:120px;height:120px;border-radius:50%;border:3px solid #a84eff;object-fit:cover;}
.online-dot{position:absolute;bottom:8px;right:8px;width:20px;height:20px;background:#00ff66;border-radius:50%;border:2px solid white;}
.section-container{margin-top:20px;background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;text-align:center;}
#friends-list{list-style:none;padding-left:0;}
#chat-box{display:none;position:fixed;bottom:20px;right:20px;width:300px;max-height:400px;background:rgba(0,0,0,0.9);border:2px solid #a84eff;border-radius:10px;flex-direction:column;padding:10px;overflow:hidden;display:flex;flex-direction:column;}
#chat-messages{flex:1;overflow-y:auto;height:250px;border-bottom:1px solid #a84eff;margin-bottom:5px;padding:5px;}
#chat-input{width:100%;padding:5px;border:none;border-radius:5px;margin-top:5px;}
@media(max-width:768px){#dashboard{width:95%;}}
</style>
</head>
<body>

<!-- LOADING -->
<div id="loading-screen">
  <div class="loader"></div>
  <p id="loading-text">Loading Johniverse...</p>
</div>

<!-- LOGIN -->
<div class="container" id="login-container">
  <h1>Login</h1>
  <input type="email" id="login-email" placeholder="Email">
  <div style="position:relative;">
    <input type="password" id="login-password" placeholder="Password">
    <span id="togglePasswordLogin" style="position:absolute; right:40px; top:15px; cursor:pointer;">üëÅÔ∏è</span>
  </div>
  <button onclick="login()">Login</button>
  <span class="link" onclick="showSignup()">Create account</span>
</div>

<!-- SIGNUP -->
<div class="container" id="signup-container">
  <h1>Sign Up</h1>
  <input type="email" id="signup-email" placeholder="Email">
  <input type="text" id="signup-username" placeholder="Username">
  <div style="position:relative;">
    <input type="password" id="signup-password" placeholder="Password">
    <span id="togglePasswordSignup" style="position:absolute; right:40px; top:15px; cursor:pointer;">üëÅÔ∏è</span>
  </div>
  <button onclick="signup()">Create Account</button>
  <span class="link" onclick="showLogin()">Back to Login</span>
</div>

<!-- DASHBOARD -->
<div id="dashboard">
  <div class="pfp-container">
    <img id="pfp" src="https://i.imgur.com/fb7yZkX.png" alt="Profile Picture">
    <div class="online-dot"></div>
  </div>
  <h2 id="username-display">Welcome, Traveler</h2>
  <button onclick="changePfp()">Change PFP</button>
  <button onclick="changeName()">Change Name</button>
  <button onclick="logout()">Logout</button>

  <!-- LINKS -->
  <div class="section-container">
    <h3>üåê Quick Links</h3>
    <a href="https://www.google.com" target="_blank" style="color:#d7baff;">Google</a> | 
    <a href="https://www.youtube.com" target="_blank" style="color:#d7baff;">YouTube</a> | 
    <a href="https://github.com" target="_blank" style="color:#d7baff;">GitHub</a>
  </div>

  <!-- WIKI -->
  <div class="section-container">
    <h3>üìö Portable Wikipedia</h3>
    <input type="text" id="wiki-query" placeholder="Search Wikipedia..." style="width:70%; padding:5px;">
    <button onclick="searchWiki()">Search</button>
    <iframe id="wiki-frame" src="" style="width:100%; height:300px; margin-top:10px; border:2px solid #a84eff;"></iframe>
  </div>

  <!-- GAMES -->
  <div class="section-container">
    <h3>üèì Games</h3>
    <button onclick="window.open('https://example.com/pingpong','_blank')">Play Ping Pong</button>
  </div>

  <!-- FRIENDS -->
  <div class="section-container">
    <h3>üë• Friends</h3>
    <ul id="friends-list"></ul>
    <input type="email" id="friend-email" placeholder="Add friend by email" style="padding:5px; margin-top:5px;">
    <button onclick="addFriend()">Add Friend</button>
  </div>

  <!-- CHAT -->
  <div class="section-container">
    <button onclick="toggleChat()">üí¨ Chat</button>
  </div>
</div>

<!-- CHAT BOX -->
<div id="chat-box">
  <div id="chat-messages"></div>
  <input type="text" id="chat-input" placeholder="Type a message..." onkeydown="if(event.key==='Enter'){sendChat();}">
  <button onclick="sendChat()">Send</button>
</div>

<script>
/* --- LOADING --- */
window.addEventListener("load", ()=>{
  setTimeout(()=>{
    document.getElementById("loading-screen").style.display="none";
    autoLogin();
  },1500);
});

/* --- PASSWORD TOGGLE --- */
document.getElementById("togglePasswordLogin").addEventListener("click",()=>{ 
  const pwd=document.getElementById("login-password"); pwd.type=pwd.type==="password"?"text":"password"; 
});
document.getElementById("togglePasswordSignup").addEventListener("click",()=>{ 
  const pwd=document.getElementById("signup-password"); pwd.type=pwd.type==="password"?"text":"password"; 
});

/* --- AUTH --- */
function showSignup(){ document.getElementById("login-container").style.display="none"; document.getElementById("signup-container").style.display="block"; }
function showLogin(){ document.getElementById("signup-container").style.display="none"; document.getElementById("login-container").style.display="block"; }

function signup(){
  const email=document.getElementById("signup-email").value.trim();
  const username=document.getElementById("signup-username").value.trim();
  const password=document.getElementById("signup-password").value.trim();
  if(!email||!password||!username){ alert("Fill all fields!"); return; }
  if(localStorage.getItem(email)){ alert("Email already exists!"); return; }
  localStorage.setItem(email, JSON.stringify({email,password,name:username,pfp:"https://i.imgur.com/fb7yZkX.png",friends:[],following:[]})); 
  localStorage.setItem("currentUser",email); 
  loadDashboard();
}

function login(){
  const email=document.getElementById("login-email").value.trim();
  const password=document.getElementById("login-password").value.trim();
  const data=JSON.parse(localStorage.getItem(email));
  if(!data||data.password!==password){ alert("Invalid login!"); return; }
  localStorage.setItem("currentUser",email);
  loadDashboard();
}

function autoLogin(){
  const current=localStorage.getItem("currentUser");
  if(current){ loadDashboard(); }
  else{ document.getElementById("login-container").style.display="block"; }
}

function loadDashboard(){
  const email=localStorage.getItem("currentUser");
  const data=JSON.parse(localStorage.getItem(email));
  if(!data){ document.getElementById("login-container").style.display="block"; return; }
  document.getElementById("login-container").style.display="none";
  document.getElementById("signup-container").style.display="none";
  document.getElementById("dashboard").style.display="flex";
  document.getElementById("username-display").innerText=data.name;
  document.getElementById("pfp").src=data.pfp;
  renderFriends();
}

/* --- ENTER KEY --- */
["login-email","login-password"].forEach(id=>document.getElementById(id).addEventListener("keypress",e=>{if(e.key==="Enter")login();}));
["signup-email","signup-username","signup-password"].forEach(id=>document.getElementById(id).addEventListener("keypress",e=>{if(e.key==="Enter")signup();}));

/* --- LOGOUT --- */
function logout(){ localStorage.removeItem("currentUser"); document.getElementById("dashboard").style.display="none"; document.getElementById("login-container").style.display="block"; }

/* --- PROFILE --- */
function changePfp(){ 
  const input=document.createElement("input"); 
  input.type="file"; input.accept="image/*";
  input.onchange=e=>{
    const file=e.target.files[0];
    const reader=new FileReader();
    reader.onload=function(){
      const email=localStorage.getItem("currentUser");
      const data=JSON.parse(localStorage.getItem(email));
      data.pfp=reader.result;
      localStorage.setItem(email,JSON.stringify(data));
      document.getElementById("pfp").src=reader.result;
    };
    reader.readAsDataURL(file);
  };
  input.click();
}
function changeName(){
  const newName=prompt("Enter new username:");
  if(!newName) return;
  const email=localStorage.getItem("currentUser");
  const data=JSON.parse(localStorage.getItem(email));
  data.name=newName;
  localStorage.setItem(email,JSON.stringify(data));
  document.getElementById("username-display").innerText=newName;
}

/* --- FRIENDS --- */
function addFriend(){
  const friendEmail=document.getElementById("friend-email").value.trim();
  const email=localStorage.getItem("currentUser");
  if(!friendEmail||friendEmail===email){ alert("Invalid email"); return; }
  const friendData=JSON.parse(localStorage.getItem(friendEmail));
  if(!friendData){ alert("No such user"); return; }
  const data=JSON.parse(localStorage.getItem(email));
  if(data.friends.includes(friendEmail)){ alert("Already friends"); return; }
  data.friends.push(friendEmail);
  localStorage.setItem(email,JSON.stringify(data));
  renderFriends();
  document.getElementById("friend-email").value="";
}
function renderFriends(){
  const email=localStorage.getItem("currentUser");
  const data=JSON.parse(localStorage.getItem(email));
  const list=document.getElementById("friends-list");
  list.innerHTML="";
  data.friends.forEach(f=>{
    const fData=JSON.parse(localStorage.getItem(f));
    if(fData){
      const li=document.createElement("li");
      li.innerText=fData.name+" ("+fData.email+")";
      list.appendChild(li);
    }
  });
}

/* --- CHAT --- */
function toggleChat(){ const box=document.getElementById("chat-box"); box.style.display=box.style.display==="flex"?"none":"flex"; }
function sendChat(){
  const input=document.getElementById("chat-input"); 
  const msg=input.value.trim(); 
  if(!msg) return;
  const messages=document.getElementById("chat-messages");
  const email=localStorage.getItem("currentUser");
  messages.innerHTML+="<p><b>"+email+":</b> "+msg+"</p>";
  input.value=""; messages.scrollTop=messages.scrollHeight;
}

/* --- WIKI --- */
function searchWiki(){
  const q=document.getElementById("wiki-query").value.trim();
  if(!q) return;
  document.getElementById("wiki-frame").src="https://en.wikipedia.org/wiki/"+encodeURIComponent(q);
}
</script>
</body>
</html>
